{"version":3,"sources":["webpack:///./src/views/home/index.vue","webpack:///./node_modules/@babel/runtime/helpers/esm/arrayWithHoles.js","webpack:///./node_modules/@babel/runtime/helpers/esm/iterableToArrayLimit.js","webpack:///./node_modules/@babel/runtime/helpers/esm/nonIterableRest.js","webpack:///./node_modules/@babel/runtime/helpers/esm/slicedToArray.js","webpack:///./src/hooks/useAuth.js","webpack:///./src/api/user.js","webpack:///./src/hooks/useWeixin.js","webpack:///index.vue","webpack:///./src/views/home/index.vue?b269","webpack:///./src/views/home/index.vue?efd1","webpack:///./src/utils/request.js"],"names":["render","_vm","this","_c","_self","_setup","_setupProxy","attrs","on","scanQRCode","previewImage","code","auth","staticRenderFns","_arrayWithHoles","arr","Array","isArray","_iterableToArrayLimit","i","_i","Symbol","iterator","_s","_e","_arr","_n","_d","call","next","done","push","value","length","err","_nonIterableRest","TypeError","_slicedToArray","arrayWithHoles","iterableToArrayLimit","unsupportedIterableToArray","nonIterableRest","SCOPES","useAuth","scope","auth_code","ref","undefined","authorize","redirect_uri","location","protocol","host","pathname","hash","r_url","href","process","encodeURIComponent","watchEffect","useUrlSearchParams","IS_PROD","includes","wxconfig","REDIRECT_URI","request","url","method","useWeixin","options","debug","useScriptTag","load","ready","instance","shallowRef","initWxConfig","nextTick","window","wx","split","res","config","Object","assign","error","needResult","scanType","success","alert","resultStr","current","urls","component","message","http","axios","create","baseURL","timeout","interceptors","use","Promise","reject","response","status","Toast","store","dispatch","name","data"],"mappings":"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","file":"static/js/chunk-71fabaa2.a8a966c4.js","sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c,_setup=_vm._self._setupProxy;return _c('div',[_c('van-cell-group',{attrs:{\"title\":\"jweixin-1.6.0\"}},[_c('van-cell',{attrs:{\"title\":\"scanQRCode\",\"is-link\":\"\"},on:{\"click\":_setup.scanQRCode}}),_c('van-cell',{attrs:{\"title\":\"previewImage\",\"is-link\":\"\"},on:{\"click\":_setup.previewImage}})],1),_c('van-cell-group',{attrs:{\"title\":\"jweixin-auth\"}},[_c('van-cell',{attrs:{\"title\":\"auth\",\"label\":_setup.code,\"is-link\":\"\"},on:{\"click\":_setup.auth}})],1)],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","export default function _arrayWithHoles(arr) {\n  if (Array.isArray(arr)) return arr;\n}","export default function _iterableToArrayLimit(arr, i) {\n  var _i = arr == null ? null : typeof Symbol !== \"undefined\" && arr[Symbol.iterator] || arr[\"@@iterator\"];\n\n  if (_i == null) return;\n  var _arr = [];\n  var _n = true;\n  var _d = false;\n\n  var _s, _e;\n\n  try {\n    for (_i = _i.call(arr); !(_n = (_s = _i.next()).done); _n = true) {\n      _arr.push(_s.value);\n\n      if (i && _arr.length === i) break;\n    }\n  } catch (err) {\n    _d = true;\n    _e = err;\n  } finally {\n    try {\n      if (!_n && _i[\"return\"] != null) _i[\"return\"]();\n    } finally {\n      if (_d) throw _e;\n    }\n  }\n\n  return _arr;\n}","export default function _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}","import arrayWithHoles from \"./arrayWithHoles.js\";\nimport iterableToArrayLimit from \"./iterableToArrayLimit.js\";\nimport unsupportedIterableToArray from \"./unsupportedIterableToArray.js\";\nimport nonIterableRest from \"./nonIterableRest.js\";\nexport default function _slicedToArray(arr, i) {\n  return arrayWithHoles(arr) || iterableToArrayLimit(arr, i) || unsupportedIterableToArray(arr, i) || nonIterableRest();\n}","import { ref, watchEffect } from 'vue'\nimport { useUrlSearchParams } from '@vueuse/core'\n\nconst SCOPES = ['snsapi_base', 'snsapi_userinfo']\n\nexport default function useAuth(scope = 1) {\n  const auth_code = ref(undefined)\n\n  watchEffect(() => {\n    const { code } = useUrlSearchParams('history')\n    auth_code.value = code\n  })\n\n  function authorize(redirect_uri) {\n    const { protocol, host, pathname, hash } = location\n    const r_url = `${protocol}//${host}${pathname}${redirect_uri ? '#' + redirect_uri : hash}`\n    location.href = `https://open.weixin.qq.com/connect/oauth2/authorize?appid=${process.env.VUE_APP_APPID}&redirect_uri=${encodeURIComponent(r_url)}&response_type=code&scope=${SCOPES[scope]}&state=STATE#wechat_redirect`\n  }\n\n  return [auth_code, authorize]\n}\n","import request from '@/utils/request'\n\nconst IS_PROD = ['production', 'staging', 'prod'].includes(process.env.NODE_ENV)\n\nexport function wxconfig(REDIRECT_URI) {\n  return request({\n    url: IS_PROD\n      ? `/api/wechat/jssdk/config?REDIRECT_URI=${REDIRECT_URI}`\n      : `/api/wechat/jssdk/configTest?REDIRECT_URI=${REDIRECT_URI}`,\n    method: 'post'\n  })\n}\n\nexport function userLogin() {\n  return request({\n    url: '/user/login',\n    method: 'post',\n  })\n}\n\nexport function userInfo() {\n  return request({\n    url: '/user/info',\n    method: 'get',\n  })\n}","import { nextTick, ref, shallowRef, watchEffect } from 'vue'\nimport { useScriptTag } from '@vueuse/core'\nimport { wxconfig } from '@/api/user'\n\nexport default function useWeixin(options = { debug: false }) {\n  const { load } = useScriptTag('//res.wx.qq.com/open/js/jweixin-1.6.0.js')\n  const ready = ref(false)\n  const instance = shallowRef(null)\n\n  watchEffect(!ready.value && initWxConfig)\n\n  async function initWxConfig() {\n    await load()\n    await nextTick()\n    instance.value = window.wx\n    try {\n      const url = encodeURIComponent(location.href.split('#')[0])\n      const res = await wxconfig(url)\n      const config = Object.assign({}, res, options)\n      instance.value.config(config)\n      instance.value.ready(() => {\n        ready.value = true\n      })\n      instance.value.error(() => {\n        ready.value = false\n      })\n    } catch (e) {\n      ready.value = false\n    }\n  }\n\n  return [ready, instance]\n}\n","<template>\n  <div>\n    <van-cell-group title=\"jweixin-1.6.0\">\n      <van-cell\n        title=\"scanQRCode\"\n        is-link\n        @click=\"scanQRCode\"\n      />\n      <van-cell\n        title=\"previewImage\"\n        is-link\n        @click=\"previewImage\"\n      />\n    </van-cell-group>\n    <van-cell-group title=\"jweixin-auth\">\n      <van-cell title=\"auth\" :label=\"code\" is-link @click=\"auth\" />\n    </van-cell-group>\n  </div>\n</template>\n\n<script setup>\nimport { useAuth, useWeixin } from '@/hooks'\n\nconst [, wx] = useWeixin()\nconst [code, authorize] = useAuth()\n\nconst scanQRCode = () => {\n  wx.value.scanQRCode({\n    needResult: 1,\n    scanType: ['qrCode', 'barCode'],\n    success: (res) => {\n      alert(res.resultStr)\n    }\n  })\n}\n\nconst previewImage = () => {\n  wx.value.previewImage({\n    current: 'https://img.yzcdn.cn/vant/apple-1.jpg',\n    urls: [\n      'https://img.yzcdn.cn/vant/apple-1.jpg',\n      'https://img.yzcdn.cn/vant/apple-2.jpg',\n      'https://img.yzcdn.cn/vant/apple-3.jpg'\n    ]\n  })\n}\n\nconst auth = () => authorize()\n</script>\n\n<style lang=\"less\">\n\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&setup=true&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&setup=true&lang=js&\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=1725ff14&\"\nimport script from \"./index.vue?vue&type=script&setup=true&lang=js&\"\nexport * from \"./index.vue?vue&type=script&setup=true&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","import axios from 'axios'\nimport store from '@/store'\nimport { Toast } from 'vant'\n\nlet message = ' (-。-)!!! 服务器开小差了，请稍后重试。'\n\n// create an axios instance\nconst http = axios.create({\n  baseURL: process.env.VUE_APP_BASE_API,\n  timeout: 50 * 1000\n})\n\nhttp.interceptors.request.use(\n  (config) => {\n    return config\n  },\n  (error) => {\n    console.log(`err,${error}`)\n    return Promise.reject(error)\n  }\n)\n\nhttp.interceptors.response.use(\n  (response) => {\n    const code = response.status\n    if (code < 200 || code > 300) {\n      Toast(`status: ${res.code}, ${message}`)\n      store.dispatch('errorLog/addErrorLog', {\n        message: message,\n        name: 'httpRequestError',\n        response,\n        url: location.href\n      })\n      return Promise.reject({\n        message: message,\n        name: 'httpRequestError',\n        response\n      })\n    } else {\n      return response.data\n    }\n  },\n  (error) => {\n    console.log(`err,${error}`)\n    Toast(`err, ${error}`)\n    store.dispatch('errorLog/addErrorLog', {\n      message: message,\n      name: 'httpRequestError',\n      response: error.response,\n      url: location.href\n    })\n    return Promise.reject(error)\n  }\n)\n\nexport default http\n"],"sourceRoot":""}